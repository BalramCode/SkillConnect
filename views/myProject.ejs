<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
    <title>SkillConnect - MyProject</title>
    <style>
        /* Ensure HTML/Body are set up for full-height fixed layouts */
        html,
        body {
            height: 100%;
            overflow: hidden;
            /* Prevent body scroll, let the specific content area scroll */
        }

        /* This class forces the right content area to take up the remaining height and scroll */
        .content-area-wrapper {
            height: 100vh;
            overflow-y: auto;
        }
    </style>
</head>

<body>
    <div class="flex h-screen bg-gray-50">
        <nav class="w-64 bg-white flex flex-col shadow-xl z-20 fixed h-full">
            <div class="flex gap-2 items-center p-5 border-b border-gray-100">
                <svg class="w-8 h-8 text-indigo-600" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M13 10V3L4 14h7v7l9-11h-7z" />
                </svg>
                <p class="text-indigo-800 font-extrabold text-2xl">SkillConnect</p>
            </div>

            <div class="mt-8 flex-grow overflow-y-auto">
                <ul class="flex flex-col gap-1 px-4 text-gray-700">
                    <li class="group">
                        <a class="flex items-center gap-3 p-3 text-lg rounded-lg transition-all duration-300"
                            href="/nav/dashboard">
                            <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 01-1 1h-3m-6 0a1 1 0001-1v-4a1 1 011-1h2a1 1 011 1v4a1 1 0001 1m-6 0h6" />
                            </svg>
                            Dashboard
                        </a>
                    </li>

                    <li class="group">
                        <a class="flex items-center gap-3 p-3 text-lg rounded-lg transition-all duration-300 hover:bg-indigo-50 hover:text-indigo-600"
                            href="/nav/projects">
                            <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V7M3 7a2 2 0 012-2h14a2 2 0 012 2M3 7h18" />
                            </svg>
                            Projects
                        </a>
                    </li>

                    <li class="group">
                        <a class="flex items-center gap-3 p-3 text-lg rounded-lg transition-all duration-300 hover:bg-indigo-50 hover:text-indigo-600"
                            href="/nav/groups">
                            <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M17 20h5v-2a3 3 0 00-3-3H5a3 3 0 00-3 3v2h5" />
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M12 12c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4z" />
                            </svg>
                            Groups
                        </a>
                    </li>

                    <li class="group">
                        <a class="flex items-center gap-3 p-3 text-lg rounded-lg transition-all duration-300 hover:bg-indigo-50 hover:text-indigo-600"
                            href="/nav/chat">
                            <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M8 10h.01M12 10h.01M16 10h.01" />
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            Chat
                        </a>
                    </li>

                    <li class="group">
                        <a class="flex items-center gap-3 p-3 text-lg rounded-lg transition-all duration-300 hover:bg-indigo-50 hover:text-indigo-600"
                            href="/nav/profile">
                            <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M16 7a4 4 0 11-8 0 4 4 0 018 0z" />
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M12 14c-4.418 0-8 3.582-8 8h16c0-4.418-3.582-8-8-8z" />
                            </svg>
                            Profile
                        </a>
                    </li>

                    <li class="group">
                        <a class="flex items-center gap-3 p-3 text-lg rounded-lg transition-all duration-300 hover:bg-indigo-50 hover:text-indigo-600  font-medium"
                            href="/nav/setting">
                            <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 01.073.431c.219 1.056 1.14 1.636 2.2 1.636h.273c1.072 0 2.053.7 2.207 1.745a.695.695 0 00.147.165l.659.659c.745.745 1.14 1.94 1.14 3.14s-.395 2.395-1.14 3.14l-.659.659c-.06.06-.11.12-.147.165c-.154 1.045-1.076 1.636-2.207 1.745h-.273c-1.06 0-1.981.58-2.2 1.636a1.724 1.724 0 01-.073.431c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 01-.073-.431c-.219-1.056-1.14-1.636-2.2-1.636h-.273c-1.072 0-2.053-.7-2.207-1.745a.695.695 0 00-.147-.165l-.659-.659c-.745-.745-1.14-1.94-1.14-3.14s.395-2.395 1.14-3.14l.659-.659c.06-.06.11-.12.147-.165c.154-1.045 1.076-1.636 2.207-1.745h.273c1.06 0 1.981-.58 2.2-1.636a1.724 1.724 0 01.073-.431z" />
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M12 14a2 2 0 100-4 2 2 0 000 4z" />
                            </svg>
                            Setting
                        </a>
                    </li>
                </ul>
            </div>

            <div class="p-4 border-t border-gray-100">
                <a href="/nav/logout"
                    class="flex items-center gap-3 p-3 text-lg rounded-lg transition-all duration-300 text-red-500 hover:bg-red-50 hover:text-red-700">
                    <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                    </svg>
                    Logout
                </a>
            </div>
        </nav>

        <div class="flex-1 ml-64 content-area-wrapper">
            <nav
                class="bg-white sticky top-0 z-10 shadow-md flex justify-between p-4 items-center h-16 border-b border-gray-100">
                <div class="font-bold text-2xl text-gray-800 ml-6">Projects</div>

                <div class="relative w-96">
                    <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"
                        xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"
                        stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 1114 0z" />
                    </svg>
                    <input
                        class="w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 transition duration-150"
                        type="text" placeholder="Search projects, teammates..." />
                </div>

                <div class="flex items-center gap-3 pr-6">
                    <div
                        class="w-10 h-10 bg-indigo-200 rounded-full flex items-center justify-center text-indigo-800 font-semibold">
                        <% const fullName=user.fullname; const nameParts=fullName.split(' ').filter(part => part.length > 0); let initials
              = ''; if (nameParts.length === 1) { initials =
              nameParts[0].substring(0, 2).toUpperCase(); } else if
              (nameParts.length >= 2) { const firstNameInitial =
              nameParts[0].charAt(0); const lastNameInitial =
              nameParts[nameParts.length - 1].charAt(0); initials =
              (firstNameInitial + lastNameInitial).toUpperCase(); } %> <%=
              initials %>
            </div>
            <div class="flex flex-col justify-center">
              <p class="font-semibold text-gray-800 leading-none">
                <%= user.fullname %>
              </p>
              <p class="text-sm text-gray-500 leading-none mt-1">
                <%= user.university %>
              </p>
            </div>
          </div>
        </nav>

        <div class="p-6">
        


  <!-- Modal Background -->
              <div id="projectModal"
                class="fixed hidden inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50">
                <!-- Modal Box -->
                <div class="bg-white rounded-xl shadow-xl w-full max-w-2xl p-6 relative max-h-[90vh] overflow-y-auto">
                  <button id="closeProjectModal"
                    class="absolute top-6 right-3 text-center text-gray-500 hover:text-black">
                    ‚úï
                  </button>

                  <h2 class="text-xl font-semibold mb-4 text-center">
                    Create New Project
                  </h2>

                  <form id="projectForm" action="/projects/create" method="post" class="space-y-4">
                    <div>
                      <label class="block text-sm font-medium">Project Name</label>
                      <input type="text" name="projectName" required
                        class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" />
                    </div>

                    <div>
                      <label class="block text-sm font-medium">Description</label>
                      <textarea name="projectDescription" required
                        class="w-full border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"></textarea>
                    </div>

                    <div>
                      <label class="block text-sm font-medium">Skill and Technology</label>
                      <input type="text" name="skill" placeholder="e.g. MERN, Python, Flutter"
                        class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" />
                    </div>
                    <div>
                      <label class="block text-sm font-medium">Maximum Members</label>
                      <input type="number" name="members" required
                        class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" />
                    </div>

                    <div>
                      <label class="block text-sm font-medium mb-2">Privacy Settings</label>

                      <div class="flex flex-col space-y-3 bg-gray-50 p-4 rounded-xl border">
                        <!-- Public Option -->
                        <label class="flex items-start space-x-3 cursor-pointer">
                          <input type="radio" name="visibility" value="public" checked
                            class="mt-1 h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500" />
                          <div>
                            <span class="font-medium text-gray-900">Public</span>
                            <p class="text-gray-500 text-sm">
                              Anyone can join this group
                            </p>
                          </div>
                        </label>

                        <!-- Private Option -->
                        <label class="flex items-start space-x-3 cursor-pointer">
                          <input type="radio" name="visibility" value="private"
                            class="mt-1 h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500" />
                          <div>
                            <span class="font-medium text-gray-900">Private</span>
                            <p class="text-gray-500 text-sm">
                              Members need approval to join
                            </p>
                          </div>
                        </label>
                        ¬†¬†
                      </div>
                    </div>

                    <div class="flex justify-end">
                      <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                        Create
                      </button>
                    </div>
                  </form>
                  ¬†¬†
                </div>
              </div>
            

          <div class="flex justify-between items-center">
            <div class="text-2xl font-semibold text-gray-800">My Projects</div>
            <button
            id="openProjectModal"
              class="flex items-center gap-1 bg-indigo-600 rounded-lg px-4 py-2 text-white font-medium transition-colors duration-200 hover:bg-indigo-700 shadow-md"
            >
              <svg
                class="w-5 h-5"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                stroke-width="2"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M12 4v16m8-8H4"
                />
              </svg>
              New Project
            </button>
          </div>

          <div class="flex gap-6 p-4 flex-wrap myProjects">
  <% 
    const userId = user._id.toString();

    const myProjects = projects.filter(project => {
      const isOwner =
        project.creator &&
        project.creator._id.toString() === userId;

      const isMember =
        project.members &&
        project.members.some(m => m.toString() === userId);

      return isOwner || isMember;
    });
  %>

  <% if (myProjects.length === 0) { %>
    <p class="text-gray-500 text-sm w-full text-center">
      You haven‚Äôt joined or created any projects yet.
    </p>
  <% } %>

  <% myProjects.forEach(function(project){ %>
    <div
      class="w-full sm:w-[305px] bg-white border border-gray-200 rounded-2xl shadow-lg p-4 transition-all duration-300 hover:shadow-2xl hover:border-indigo-500 hover:-translate-y-1"
    >
      <!-- Title + Icon + Visibility -->
      <div class="flex items-center gap-2 text-sm font-semibold text-gray-800">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-5 h-5 text-indigo-600 flex-shrink-0"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
          stroke-width="1.8"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M9 13h6m-3-3v6m-9 1A7 7 0 0121 17V7a4 4 0 00-4-4H7a4 4 0 00-4 4v10z"
          />
        </svg>

        <p class="capitalize flex-1 truncate">
          <%= project.projectName %>
        </p>

        <span
          class="text-xs px-2 py-0.5 rounded-full
          <%= project.visibility.trim() === 'public' ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700' %>"
                            >
                            <%= project.visibility %>
                                </span>
                    </div>

                    <!-- Description -->
                    <p class="truncate mt-4 text-gray-600 text-sm leading-relaxed">
                        <%= project.projectDescription %>
                    </p>

                    <!-- Skills -->
                    <div class="mt-4 flex gap-2 text-xs font-medium text-gray-700 flex-wrap">
                        <span class="px-2.5 py-1 bg-gray-100 rounded-lg border">
                            <%= project.skill %>
                        </span>
                    </div>

                    <!-- Meta -->
                    <div
                        class="mt-5 pt-4 border-t border-gray-100 flex justify-between text-xs text-gray-500 font-medium">
                        <span class="inline-flex items-center gap-1">
                            üë• <%= project.members.length %>
                        </span>

                        <span class="flex items-center gap-1">
                            ‚è±
                            <%= new Date(project.createdAt).toLocaleDateString('en-US', { month: 'short' ,
                                day: 'numeric' }) %>
                        </span>
                    </div>

                    <!-- Owner -->
                    <p class="mt-2 text-xs text-gray-500">
                        Owned by
                        <span class="font-semibold text-gray-700">
                            <%= project.creator.fullname %>
                        </span>
                    </p>

                    <!-- Actions -->
                    <div class="flex justify-center gap-2 mt-3">
                        <a href="/projects/project/<%= project._id %>"
                            class="w-[48%] flex justify-center items-center gap-1 bg-indigo-600 text-white font-medium rounded-md py-1.5 shadow hover:bg-indigo-700 transition-all duration-200 active:scale-95 text-xs">
                            View
                        </a>


                    </div>
                </div>
                <% }) %>
        </div>


    </div>
    </div>
    </div>
    <script>
        const openBtn = document.getElementById("openProjectModal");
        const closeBtn = document.getElementById("closeProjectModal");
        const modal = document.getElementById("projectModal");
        const form = document.getElementById("projectForm");

        openBtn.addEventListener("click", () => modal.classList.remove("hidden"));
        closeBtn.addEventListener("click", () => modal.classList.add("hidden"));
        window.addEventListener("click", (e) => {
            if (e.target === modal) modal.classList.add("hidden");
        });

        form.addEventListener("submit", () => {
            modal.classList.add("hidden");
        });
    </script>
</body>

</html>